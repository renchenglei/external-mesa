From 6cec69c4d9dbfed96c22b5fc967ae8531ae4767a Mon Sep 17 00:00:00 2001
From: renchenglei <chenglei.ren@intel.com>
Date: Wed, 4 Mar 2020 17:45:02 +0800
Subject: [PATCH] INTERNAL: anv: disable extensions for Android CTS
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This change makes following test pass:
dEQP-VK.api.info.device.extensions
dEQP-VK.api.info.android.no_unknown_extensions

Originally-from: Tapani PÃ¤lli <tapani.palli@intel.com>
Test: [CTS 10.0_r3] dEQP-VK.api.info.device.extensions
      [CTS 10.0_r3] dEQP-VK.api.info.android.no_unknown_extensions
Signed-off-by: Kevin Strasser <kevin.strasser@intel.com>
Signed-off-by: Chenglei Ren <chenglei.ren@intel.com>
---
 src/intel/vulkan/anv_extensions.py | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/src/intel/vulkan/anv_extensions.py b/src/intel/vulkan/anv_extensions.py
index 2c2bea1806a8..617164f1edc7 100644
--- a/src/intel/vulkan/anv_extensions.py
+++ b/src/intel/vulkan/anv_extensions.py
@@ -95,30 +95,30 @@ EXTENSIONS = [
     Extension('VK_KHR_get_physical_device_properties2',   1, True),
     Extension('VK_KHR_get_surface_capabilities2',         1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_image_format_list',                 1, True),
-    Extension('VK_KHR_imageless_framebuffer',             1, True),
+    Extension('VK_KHR_imageless_framebuffer',             1, '!ANDROID'),
     Extension('VK_KHR_incremental_present',               1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_maintenance1',                      1, True),
     Extension('VK_KHR_maintenance2',                      1, True),
     Extension('VK_KHR_maintenance3',                      1, True),
     Extension('VK_KHR_multiview',                         1, True),
-    Extension('VK_KHR_pipeline_executable_properties',    1, True),
+    Extension('VK_KHR_pipeline_executable_properties',    1, '!ANDROID'),
     Extension('VK_KHR_push_descriptor',                   1, True),
     Extension('VK_KHR_relaxed_block_layout',              1, True),
     Extension('VK_KHR_sampler_mirror_clamp_to_edge',      1, True),
     Extension('VK_KHR_sampler_ycbcr_conversion',          1, True),
     Extension('VK_KHR_shader_atomic_int64',               1,
               'device->info.gen >= 9 && device->use_softpin'),
-    Extension('VK_KHR_shader_clock',                      1, True),
+    Extension('VK_KHR_shader_clock',                      1, '!ANDROID'),
     Extension('VK_KHR_shader_draw_parameters',            1, True),
     Extension('VK_KHR_shader_float16_int8',               1, 'device->info.gen >= 8'),
     Extension('VK_KHR_shader_float_controls',             1, 'device->info.gen >= 8'),
-    Extension('VK_KHR_shader_subgroup_extended_types',    1, 'device->info.gen >= 8'),
-    Extension('VK_KHR_spirv_1_4',                         1, True),
+    Extension('VK_KHR_shader_subgroup_extended_types',    1, 'device->info.gen >= 8 && !ANDROID'),
+    Extension('VK_KHR_spirv_1_4',                         1, '!ANDROID'),
     Extension('VK_KHR_storage_buffer_storage_class',      1, True),
     Extension('VK_KHR_surface',                          25, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_surface_protected_capabilities',    1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_swapchain',                        70, 'ANV_HAS_SURFACE'),
-    Extension('VK_KHR_uniform_buffer_standard_layout',    1, True),
+    Extension('VK_KHR_uniform_buffer_standard_layout',    1, '!ANDROID'),
     Extension('VK_KHR_variable_pointers',                 1, True),
     Extension('VK_KHR_vulkan_memory_model',               3, True),
     Extension('VK_KHR_wayland_surface',                   6, 'VK_USE_PLATFORM_WAYLAND_KHR'),
@@ -164,8 +164,8 @@ EXTENSIONS = [
     Extension('VK_EXT_ycbcr_image_arrays',                1, True),
     Extension('VK_ANDROID_external_memory_android_hardware_buffer', 3, 'ANDROID'),
     Extension('VK_ANDROID_native_buffer',                 7, 'ANDROID'),
-    Extension('VK_GOOGLE_decorate_string',                1, True),
-    Extension('VK_GOOGLE_hlsl_functionality1',            1, True),
+    Extension('VK_GOOGLE_decorate_string',                1, '!ANDROID'),
+    Extension('VK_GOOGLE_hlsl_functionality1',            1, '!ANDROID'),
     Extension('VK_INTEL_performance_query',               1, 'device->perf'),
     Extension('VK_NV_compute_shader_derivatives',         1, True),
 ]
-- 
2.17.1

